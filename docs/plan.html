<!DOCTYPE html>
<html>
<head>
	<style>
		body {
			float: left;
			margin: 5ex 10ex;
			background-color: #f0f0f0;
			font-family: sans-serif;
			color: #444;
			position: relative;
		}
		h1 {
			font-weight: normal;
		}
		li {
			padding-left: 1em;
		}
		.day {
			width: 100%;
		}
		h1, h2, h3, p, ul, li, pre {
			width: 60%;
			min-width: 350px
		}
		ul {
			margin: 0;
			padding-left: 2em;
		}
		li {
			padding-left: 0.5em;
		}
		img {
			display: block;
			width: 30%;
			padding: 10px 0;
		}
		pre {
			border-radius: 0.5em;
			padding: 1em;
			background-color: #d0e0f0;
		}
	</style>
</head>
<body>
<h1 style="text-align:center; width:100%;">Project Log - SDD Task 2</h1>

<h1 class="day">14th May 2019</h1>
<img src="s1_20190514.png">
<h3>What does a cinema booking site need to do?</h3>
<ul>
	<li>Check how many seats are left.</li>
	<li>List the sessions at different cinemas.</li>
</ul>
<h3>Reservations:</h3>
<ul>
	<li>Collect Names</li>
	<li>Verification? Email...?</li>
	<li>Seat IDs</li>
</ul>
<h3>Main Page:</h3>
<h3>Sessions:</h3>
<ul>
	<li>By Cinema</li>
	<li>By Movie</li>
</ul>
<h3>Session Page / Booking Page:</h3>
<ul>
	<li>Available seats/ seating diagram</li>
	<li>Prices</li>
</ul>
<h3>Methods for page generation:</h3>
<ul>
	<li>AJAX : More Tricky, Modular, Demo of dynamic ts execution (stdout of file as output?? or import module??)</li>
	<li>Server Pre-Rendered : Simple, Not so modular, Demo of TypeScriptPages</li>
</ul>
<h3>Visits:</h3>
<ul>
	<li>https://stackoverflow.com/questions/3451111/unzipping-files-in-python/3451150</li>
	<li>https://stackabuse.com/download-files-with-python/</li>
	<li>https://www.tutorialspoint.com/How-can-I-create-a-directory-if-it-does-not-exist-using-Python</li>
</ul>
<h3>Work Done:</h3>
<ul>
	<li>Setup Script (Install Dependencies)</li>
	<li>Start Script</li>
	<li>File Directory Structure</li>
	<li>Boilerplate</li>
</ul>
<h3>Algorithms:</h3>
<pre><code>BEGIN MAIN
  LAUNCH WebServer
END
</code></pre>

<h1 class="day">15th May 2019</h1>
<img src="s2_20190515.png">
<h3>Algorithms:</h3>
<pre><code>BEGIN GET Sessions
	GET Venues
	FOR each venue, get sessions
END
</code></pre>
<h3>Pages</h3>
<ul>
	<li>Login</li>
	<li>Home Screen - Select based on Session or Location</li>
	<li>Session Booking</li>
	<li>Available Sessions</li>
</ul>
<h3>Work Done:</h3>
<ul>
	<li>HomePage</li>
</ul>

<h1 class="day">16th May 2019</h1>
<h3>Work Done:</h3>
<ul>
	<li>Logo</li>
</ul>

<h1 class="day">23rd May 2019</h1>
<img src="s3_20190523.png">
<h3>Work Done:</h3>
<ul>
	<li>Styling of homepage - Colour, Fancy Graphics</li>
</ul>
<h3>Images Sourced:</h3>
<ul>
	<li>https://www.publicdomainpictures.net/pictures/120000/nahled/seamless-carpet-pattern.jpg</li>
</ul>

<h1 class="day">29th July 2019</h1>
<h3>Some Required Features</h3>
<ul>
	<li>Display a homepage</li>
	<li>Select by cinema or by film</li>
	<li>By Cinema: Select cinema, then list available films there</li>
	<li>By Film: List all times in order, and display cinema underneath.</li>
	<li>Data Storage: Films as an Object, Cinemas as an object. Cinema is a parent of films.</li>
	<li></li>
</ul>
<h3>Example Storage</h3>
<pre><code>{
  "sessions": [
    {
      "cinema": 1,
      "film": 1,
      "time": "YYYY-MM-DDZ00:00:00"
    }
  ],
  "cinemas": [
    {
      "name": "Hornsby",
      "address": "01 Main Street,Hornsby,NSW,Australia",
      "rooms": 2
    }
  ],
  "films": [
    {
      "name": "Spiderman: Far From Home",
      "duration": "2h19m",
      "director": "NAME HERE",
      "description": "Really Good Wow!",
      "thumbnail": "IMG_1.png"
    }
  ]
}</code></pre>

<h1 class="day">6th August 2019</h1>
<h3>Work</h3>
<ul>
	<li>HTML seat.</li>
	<li></li>
</ul>

<h1 class="day">12th August 2019</h1>
<h3>Get Sessions Algorithm</h3>
<pre><code>
BEGIN GetSessions
	GET cinema
	GET film
	SET foundSessions = []
	FOR EACH session in list of sessions
		IF session cinema = cinema AND session film = film THEN
			add session to foundSessions
		END IF
	NEXT
	RETURN foundSessions
END
</code></pre>
<h3>Get Taken Seats Algorithm</h3>
<pre><code>
BEGIN GetTakenSeats
	GET sessionSeats
	GET sessionId
	SET takenSeats = []
	FOR EACH seat in sessionSeats
		IF seat session = sessionId THEN
			add seat to takenSeats
		END IF
	NEXT
	RETURN takenSeats
END
</code></pre>

<h3>Data Store</h3>
<pre><code>
Time is stored in 0000: hhmm;
{
	"cinemas": [
		{
			"id": "spx_suburb",
			"name": "Suburb",
			"address": "1 Main Street"
		}
	],
	"films": [
		{
			"id": "film_name"
			"name": "Film: Name",
			"duration": "0000",
			"trailer": "http://trailer.site/042.avi",
			"director": "Name Here",
			"description": "A thriller from the creators of nothing."
		}
	],
	"sessions": [
		{
			"id": "session_1234567890",
			"cinema": "spx_suburb",
			"film": "film_name",
			"time": "1200"
		}
	],
	"bookings": [
		{
			"id": "1234567890"
			"session": "session_1234567890"
			"seat": "A1",
			"name": "Name Here",
			"phone": "1234567890",
			"email": "1234567890",
			"code": "1234567890",
			"date": "YYYY-MM-DD"
		}
	]
}
</code></pre>
<h3>Work</h3>
<p>Created Data File</p>
<p>XHR for AJAX json requests - https://www.w3schools.com/js/js_json_http.asp</p>
<h3>Debugging Debugging Errors</h3>
<img src="s4_20190812.png">
<p>
<strong>Expected: </strong>When visiting a page
that does not exist (such as /maths),
the user should be presented with an error page.
As an initial test, this page displays only a
heading with the error code.
</p><img src="s5_20190812.png"><p>
<strong>Problem: </strong>When a page is displayed,
the browser uses the <code>Content-Type</code> header
to determine the language defining page presentation.
Thus, the above image of the page showing the source
occurs.
</p><img src="s6_20190812.png"><p>
<strong>Cause: </strong>Inspecting the response headers,
the <code>Content-Type</code> header is set to text/plain.
This is ideal when sending basic data or for easily
viewing page data when debugging. But here it means
that the page is not represented in HTML but rather
displays the page markup source.
</p><img src="s7_20190812.png"><p>
<strong>Solution: </strong>To change the
<code>Content-Type</code> header to be
<code>text/html</code>. Now it shows correctly.
</p>
<img src="s8_20190812.png">

<h1 class="day">12th August 2019</h1>
<h3>Implement APIs</h3>
<a href="https://regexr.com/">https://regexr.com/</a>

<h1 class="day">13th August 2019</h1>
<h3>Screens Plan (Copied from Paper)</h3>
<img src="s26.png">
<h3>Debugging API</h3>
<img src="s9_20190813.png">
<p>
	This block of code is what differentiates
	an API request from a normal html request.
</p>
<img src="s10_20190813.png">
<p>
	The browser here is display the page using
	text purely. It has substituted an image not
	found icon in and fonts and backgrounds are
	not being followed as per the stylesheet.
</p>
<img src="s11_20190813.png">
<p>
	The first hint of the problem is when inspecting
	what the browser receives as `logo.png`. A png
	should be served with the `image/png` MIME type,
	however it is `text/html`;
</p>
<img src="s12_20190813.png">
<p>
	Upon further inspection, the main.css file is not
	being received as css. It is actually being
	send the index.html page which is in no way a 
	stylesheet.
</p>
<img src="s13_20190813.png">
<p>
	Inspecting the server logs, lines such as `/main.css`
	show the client's request url, the `URL>` part shows
	what the server has request the path to.
	Interestingly enough they all resolve to `index.html`.
</p>
<img src="s14_20190813.png">
<p>
	Further inspection of the filepath handling function
	shows that after the if statements, filepath is set.
	This means that regardless of what was decided, it is
	immediately overridden. In this case, rootDir is "./src/web"
	and filename is "index.html" resulting in the above examples
	from the server console.
</p>
<h3>Fixing 404 Content-Type</h3>
<img src="s15_20190813.png">
<p>
	The above problem is a minor one, although
	it technically does break WWW standards. An image 
	file should not be classified as MIME-type
	"text/html". So it's interesting why its appeared as such.
</p>
<img src="s16_20190813.png">
<p>
	The code documented for error 404 here is the
	source of the problem. No matter what,
	there is no condition or check for the file type 
	of the requested resource. It automatically
	sets the content type header to html and returns
	a "pretty" 404 page.
</p>
<img src="s17_20190813.png">
<p>
	This can be correct with a simple check to see
	if the requested resource is a html file or not,
	and then not setting a content-type header.
</p>
<img src="s18_20190813.png">
<p>
	The only problem now is that it appears as text/plain,
	which is not great.
</p>
<img src="s19_20190813.png">
<p>
	Looking into further details of the server's response through
	Google Chrome's inspector, it is interesting that a content-type is
	assigned even though the response's length is 0.
</p>
<img src="s20_20190813.png">
<p>
	The server now sends content-type as empty to hopefully tell the
	brower to not care about the type.
</p>
<img src="s21_20190813.png">
<p>
	Checking with inspector confirms that content-type is none.
</p>
<img src="s22_20190813.png">
<p>
	Unfortunately it seems that Chrome's default MIME-type is "text/plain"
	which is interesting to note, but unimportant.
	MIME-types are a standard way to describe the contents of a file.
	With the format generally following ("category"/"extension"), e.g. a ".json" file
	is represented as "application/json" as it is used by/for applications and its extension is ".json".
</p>
<h3>Buttons for Selecting</h3>
<img src="s23_20190813.png">

<h1 class="day">21st August 2019</h1>
<h3>Implementing API / URL Handling</h3>
<p>
	A function takes in an object and using the provided
	keys and the request url, looks for and finds defined
	functions to run upon certain urls. If there is no such
	function then it calls the [DEFAULT_SYMBOL] which is a
	special JavaScript data-entity called a symbol, which
	acts as a unique identifier in this case as the
	key for the function value if no other keys satisfy
	the request url.
</p>
<img src="s24.png">
<img src="s25.png">

<h1 class="day">6th September 2019</h1>
<h3>Get days of the next 7 days (including today)</h3>
<pre><code>
BEGIN SPXWeek
	GET todayDate
	SET week = []
	FOR integers i 0 to 6
		add to week, todayDate + "i" days
	NEXT
	RETURN week
END
</code></pre>
<h3>Get booking preview</h3>
<pre><code>
BEGIN ViewBooking
	GET bookingId
	FOR each storedBookingId, storedBooking in bookings datastore
		IF bookingId = storedBookingId THEN
			SET selectedBooking = storedBooking
		END IF
	NEXT
	DISPLAY selectedBooking
END
</code></pre>
<h3>Some Algorithms</h3>
<img src="s27.png">
<h3>Main Menu Final Screen Design</h3>
<img src="s28.png">
<h3>Seat Booking Final Design</h3>
<img src="s29.png">
<h3>Sessions List Final Design</h3>
<img src="s30.png">
</body>
</html>